.. skbel documentation master file, created by
   sphinx-quickstart on Sat May 29 18:15:24 2021.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

SKBEL - Bayesian Evidential Learning for Python
===============================================

.. currentmodule:: SKBEL

This package implements the Bayesian Evidential Learning (BEL) framework.
BEL is a method that combines machine learning and Monte Carlo simulations to help improve the estimation of prediction uncertainty (Hermans et al., 2016, 2018; Michel et al., 2020; Thibaut et al., 2021).

It uses a direct relationship between predictor (data) and target (prediction), learned from a training set sampled from the prior distribution, to perform the Bayesian inference (typically within a low-dimensional latent space).

Its effectiveness has been shown through extensive synthetic validation, but also against rejection sampling (Scheidt et al., 2015), Markov chain Monte Carlo (McMC) algorithms (Michel et al., 2020, 2022), field data (Hermans et al., 2019), and experimental design (Thibaut et al., 2021; 2022).

Previous studies have demonstrated that BEL can estimate the posterior distribution of parameters in a variety of contexts, including geothermal systems (Athens & Caers, 2019; Hermans et al., 2018, 2019), contaminant transport (Satija & Caers, 2015; Scheidt et al., 2015), and geophysical inversion (Hermans et al., 2016; Michel et al., 2020). Additionally, a variety of subsurface field cases, including groundwater, shallow and deep geothermal, and oil/gas predictions, have been successfully applied using the BEL framework (J. Park & Caers, 2020; Pradhan & Mukerji, 2020; Tadjer & Bratvold, 2021).

Installation
------------

SKBEL is available through `PyPI <https://pypi.org/project/skbel/>`_, and may be installed using ``pip``: ::

   $ pip install skbel

Contents
-----------------

.. toctree::
   :maxdepth: 2

   source/modules.rst
   source/examples.rst

Bayesian Evidential Learning
----------------------------
Introduction
.............

.. image:: /img/evidential.png
   :width: 800


Figure 1: The concept of BEL. d = predictor (observed data), h = target (parameter of interest), m = model.

- The idea of BEL is to find a direct relationship between `d` (predictor) and `h` (target) in a reduced dimensional space with machine learning.
- Both `d` and `h` are generated by forward modelling from the same set of prior models `m`.
- Given a new measured predictor `d*`, this relationship is used to infer the posterior probability distribution of the target, without the need for a computationally expensive inversion.
- The posterior distribution of the target is then sampled and back-transformed from the reduced dimensional space to the original space to predict posterior realizations of `h` given `d*`.

Typical Workflow
.................
Forward modeling
++++++++++++++++

- Examples of both `d` and `h` are generated through forward modeling from the same model `m`. Target and predictor are real, multi-dimensional random variables.

Pre-processing
++++++++++++++++

- Specific pre-processing is applied to the data if necessary (such as scaling).

Dimensionality reduction
+++++++++++++++++++++++++

- Principal Component Analysis (PCA) is applied to both target and predictor to aggregate the correlated variables into a few independent Principal Components (PC’s).

Learning
++++++++++++++++

- Canonical Correlation Analysis (CCA) transforms the two sets into pairs of Canonical Variates (CV’s) independent of each other.

Post-processing
++++++++++++++++

- Specific post-processing is applied to the CV's if necessary (such as CV normalization).

Posterior distribution inference
+++++++++++++++++++++++++++++++++++

- The mean `μ` and covariance `Σ` of the posterior distribution of an unknown target given an observed `d*` can be directly estimated from the CV's distribution.
- Alternatively, the posterior conditional distribution can be inferred through KDE or transport maps.

Sampling and back-transformation to the original space
+++++++++++++++++++++++++++++++++++++++++++++++++++++++

- The posterior distribution is sampled to obtain realizations of `h` in canonical space, successively back-transformed to the original space.

.. image:: /img/flow-01.png
   :width: 800

Figure 2: Typical BEL workflow.

Contributing
------------

Contributors and feedback from users are welcome. Don't hesitate to submit an issue or a PR, or request a new feature.

Other resources
-----------------

Hadrien Michel (University of Liège) and colleagues have been working on their own implementation of BEL called `pyBEL1D <https://github.com/hadrienmichel/pyBEL1D>`_.
pyBEL1D is a program for the stochastic 1D imaging of the subsurface based on geophysical data `(Michel et al., 2020) <https://www.sciencedirect.com/science/article/pii/S0098300419306028?via%3Dihub>`_.

About the authors
-----------------

The first and main author is MSc. Ir. `Robin Thibaut <https://orcid.org/0000-0001-7556-2700>`_, who developed this package as part of his doctoral research project: `A new framework for Experimental Design in Earth Sciences using Bayesian Evidential Learning (BEL4ED) <https://www.researchgate.net/project/A-new-framework-for-Experimental-Design-in-Earth-Sciences-using-Bayesian-Evidential-Learning-BEL4ED>`_ at Ghent University, Department of Geology, `Laboratory for Applied Geology and Hydrogeology (LTGH) <https://www.ugent.be/we/geologie/en/research/organization/applied-geology-and-hydrogeology>`_.
His advisors are Prof. Dr. Ir. `Thomas Hermans <https://orcid.org/0000-0001-9522-1540>`_ (Ghent University) and Dr. Ir. `Eric Laloy <https://scholar.google.com/citations?user=QrvhkvQAAAAJ&hl=en>`_ (SCK CEN: Belgian Nuclear Research Centre).

The second author is Dr. `Maximilian Ramgraber <https://www.maxramgraber.com/>`_ (Massachusetts Institute of Technology), who has implemented the transport maps algorithm in this package.

Note: information about the authors last updated on 2022-10-29

References
=============

The list of references below contains a collection of papers or books that use or describe the BEL framework (not necessarily using SKBEL).

.. bibliography::
   :all:

Indices and tables
==================

* :ref:`genindex`
* :ref:`modindex`
* :ref:`search`
